import React, { useState } from "react";
import { NavLink, Link } from "react-router-dom";
import { useAuth } from "../../context/auth";
import toast from "react-hot-toast";
import SearchInput from "../Form/SearchInput";
import { FontAwesomeIcon } from "@fortawesome/react-fontawesome";
import { faBars, faXmark } from "@fortawesome/free-solid-svg-icons";
import useCategory from "../../hooks/useCategory";
import { useCart } from "../../context/cart";
import "../../styles/components/layout/header.css";
import { Badge } from "antd";

const Header = () => {
  const [auth, setAuth] = useAuth();
  const [cart] = useCart();
  const categories = useCategory();
  const handleLogout = () => {
    setAuth({
      ...auth,
      user: null,
      token: "",
    });
    localStorage.removeItem("auth");
    toast.success("Logout Successfully");
  };
  const [nav, setNav] = useState(false);

  const openNav = () => {
    setNav(!nav);
  };

  return (
    <div className="navbar-section">
      <h1 className="navbar-title">
        <Link to="/">
          <img
            src="/images/LogoHeader.png"
            alt="Logo"
            className="navbar-logo"
          />
          TimelessPieces
        </Link>
      </h1>

      {/* Desktop */}
      <div className="search-input-desktop">
        <SearchInput />
      </div>
      <ul className="navbar-items">
        <li>
          <Link to="/" className="navbar-links">
            Home
          </Link>
        </li>
        <li className="nav-item dropdown">
          <Link
            className="nav-link dropdown-toggle navbar-links"
            to={"/categories"}
            data-bs-toggle="dropdown"
          >
            Categories
          </Link>
          <ul className="dropdown-menu">
            <li>
              <Link className="dropdown-item" to={"/categories"}>
                All Categories
              </Link>
            </li>
            {categories?.map((c) => (
              <li key={c.id}>
                <Link className="dropdown-item" to={`/category/${c.slug}`}>
                  {c.name}
                </Link>
              </li>
            ))}
          </ul>
        </li>
        {!auth.user ? (
          <>
            <li className="nav-item">
              <NavLink to="/register" className="navbar-links">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="26"
                  viewBox="0 -960 960 960"
                  width="26"
                >
                  <path d="M98.847-187.694v-88.922q0-31.846 16.039-55.653 16.038-23.807 42.577-37.269 51-26 107.691-42.077 56.692-16.076 133.692-16.076 30 0 55.808 2.423 25.807 2.423 48.191 7.269l-53.075 53.075q-11-2-23.808-2.384-12.808-.385-27.116-.385-71 0-124.423 15.846T185-316.001q-13.615 7.308-19.885 17.077-6.269 9.77-6.269 22.308v28.923h242.307l59.999 59.999H98.848ZM617-157.847 492.847-282 535-324.153l82 82 202-202L861.152-402 617-157.847ZM398.846-492.309q-57.749 0-98.874-41.124-41.124-41.125-41.124-98.874 0-57.75 41.124-98.874 41.125-41.125 98.874-41.125 57.749 0 98.874 41.125 41.125 41.124 41.125 98.874 0 57.749-41.125 98.874-41.125 41.124-98.874 41.124Zm2.307 244.616Zm-2.307-304.614q33 0 56.5-23.5t23.5-56.5q0-33-23.5-56.5t-56.5-23.5q-33 0-56.5 23.5t-23.5 56.5q0 33 23.5 56.5t56.5 23.5Zm0-80Z" />
                </svg>{" "}
                Register
              </NavLink>
            </li>
            <li className="nav-item">
              <NavLink to="/login" className="navbar-links">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="24"
                  viewBox="0 -960 960 960"
                  width="24"
                >
                  <path d="M479.615-140.001V-200h268.076q4.616 0 8.463-3.846 3.846-3.847 3.846-8.463v-535.382q0-4.616-3.846-8.463-3.847-3.846-8.463-3.846H479.615v-59.999h268.076q30.308 0 51.308 21t21 51.308v535.382q0 30.308-21 51.308t-51.308 21H479.615Zm-54.229-169.232-41.537-43.383 97.384-97.385H140.001v-59.998h341.232l-97.384-97.385 41.537-43.383L596.154-480 425.386-309.233Z" />
                </svg>{" "}
                Login
              </NavLink>
            </li>
          </>
        ) : (
          <>
            <li className="nav-item dropdown">
              <NavLink
                className="nav-link dropdown-toggle navbar-links"
                to="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="27"
                  viewBox="0 -960 960 960"
                  width="27"
                >
                  <path d="M245.498-268.807q51.772-37.346 109.618-58.462Q412.962-348.384 480-348.384q67.038 0 124.884 21.115 57.846 21.116 109.846 58.462 38.424-42.115 59.828-95.525 21.404-53.41 21.404-115.674 0-131.686-92.135-223.821Q611.692-795.962 480-795.962t-223.827 92.135q-92.135 92.135-92.135 223.821 0 62.264 21.404 115.674 21.404 53.41 60.056 95.525Zm234.624-182.809q-54.276 0-91.391-36.993t-37.115-91.269q0-54.276 36.993-91.391t91.269-37.115q54.276 0 91.391 36.993t37.115 91.269q0 54.276-36.993 91.391t-91.269 37.115ZM480-108.078q-77.252 0-145.238-29.225-67.985-29.224-118.123-79.461-50.138-50.237-79.349-118.151-29.212-67.914-29.212-145.181 0-77.349 29.225-145.238 29.224-67.889 79.461-118.027 50.237-50.138 118.151-79.349 67.914-29.212 145.181-29.212 77.349 0 145.238 29.225 67.889 29.224 118.027 79.461 50.138 50.237 79.349 118.038Q851.922-557.397 851.922-480q0 77.252-29.225 145.238-29.224 67.985-79.461 118.123-50.237 50.138-118.038 79.349Q557.397-108.078 480-108.078Zm-.012-55.96q53.358 0 102.57-17.02 49.212-17.019 89.52-48.327-40.308-29.654-88.354-46.346-48.047-16.693-103.652-16.693-55.606 0-104.262 16.154-48.657 16.154-87.888 46.885 40.308 31.308 89.508 48.327 49.201 17.02 102.558 17.02ZM480-507.576q30.346 0 51.385-21.039 21.039-21.039 21.039-51.385 0-30.346-21.039-51.385-21.039-21.039-51.385-21.039-30.346 0-51.385 21.039-21.039 21.039-21.039 51.385 0 30.346 21.039 51.385 21.039 21.039 51.385 21.039ZM480-580Zm0 351.769Z" />
                </svg>
                {auth?.user?.name}
              </NavLink>
              <ul className="dropdown-menu">
                <li>
                  <NavLink
                    to={`/dashboard/${
                      auth?.user?.role === 1 ? "admin" : "user"
                    }`}
                    className="dropdown-item"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="24"
                      viewBox="0 -960 960 960"
                      width="24"
                    >
                      <path d="M680-280q25 0 42.5-17.5T740-340q0-25-17.5-42.5T680-400q-25 0-42.5 17.5T620-340q0 25 17.5 42.5T680-280Zm0 120q31.385 0 57.192-14.308 25.808-14.307 42.193-38.307Q757-226 732-233q-25-7-52-7t-52 7q-25 7-47.385 20.385 16.385 24 42.193 38.307Q648.615-160 680-160Zm-200 59.229q-129.769-35.384-214.884-152.768Q180.001-370.924 180.001-516v-230.153L480-858.46l299.999 112.307v226.616q-14-5.693-29.384-10.269-15.385-4.577-30.615-7.193v-167.386L480-794l-240 89.615V-516q0 53.154 15 103.808 15 50.655 41.347 94.693 26.346 44.039 62.962 79.077t79.462 55.961l1.154-.384q7.923 21.999 20.538 42.152 12.615 20.153 28.691 36.614-2.538.77-4.577 1.654-2.038.885-4.577 1.654Zm200 .77q-74.922 0-127.461-52.538Q500.001-205.078 500.001-280t52.538-127.461Q605.078-459.999 680-459.999t127.461 52.538Q859.999-354.922 859.999-280t-52.538 127.461Q754.922-100.001 680-100.001ZM480-488.23Z" />
                    </svg>{" "}
                    Dashboard
                  </NavLink>
                </li>
                <li className="dropdown-item">
                  <NavLink
                    onClick={handleLogout}
                    to="/login"
                    className="nav-link"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="24"
                      viewBox="0 -960 960 960"
                      width="24"
                    >
                      <path d="M212.309-140.001q-30.308 0-51.308-21t-21-51.308v-535.382q0-30.308 21-51.308t51.308-21h268.076V-760H212.309q-4.616 0-8.463 3.846-3.846 3.847-3.846 8.463v535.382q0 4.616 3.846 8.463 3.847 3.846 8.463 3.846h268.076v59.999H212.309Zm436.922-169.232-41.537-43.383 97.384-97.385H363.846v-59.998h341.232l-97.384-97.385 41.537-43.383L819.999-480 649.231-309.233Z" />
                    </svg>{" "}
                    Logout
                  </NavLink>
                </li>
              </ul>
            </li>
          </>
        )}
        <li className="nav-item">
          <Badge count={cart?.length} showZero>
            <NavLink to="/cart" className="navbar-links">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                height="24"
                viewBox="0 -960 960 960"
                width="24"
              >
                <path d="M252.309-100.001q-30.308 0-51.308-21t-21-51.308v-455.382q0-30.308 21-51.308t51.308-21h77.692v-10q0-62.154 43.923-106.077Q417.846-859.999 480-859.999q62.154 0 106.076 43.923 43.923 43.923 43.923 106.077v10h77.692q30.308 0 51.308 21t21 51.308v455.382q0 30.308-21 51.308t-51.308 21H252.309Zm0-59.999h455.382q4.616 0 8.463-3.846 3.846-3.847 3.846-8.463v-455.382q0-4.616-3.846-8.463-3.847-3.846-8.463-3.846h-77.692v90.001q0 12.769-8.615 21.384T600-520q-12.769 0-21.384-8.615t-8.615-21.384V-640H389.999v90.001q0 12.769-8.615 21.384T360-520q-12.769 0-21.384-8.615t-8.615-21.384V-640h-77.692q-4.616 0-8.463 3.846-3.846 3.847-3.846 8.463v455.382q0 4.616 3.846 8.463 3.847 3.846 8.463 3.846Zm137.69-539.999h180.002v-10q0-37.616-26.193-63.808Q517.616-800 480-800t-63.808 26.193q-26.193 26.192-26.193 63.808v10ZM240-160V-640-160Z" />
              </svg>{" "}
              Cart
            </NavLink>
          </Badge>
        </li>
      </ul>

      {/* Mobile */}
      <div className={`mobile-navbar ${nav ? "open-nav" : ""}`}>
        <div onClick={openNav} className="mobile-navbar-close">
          <FontAwesomeIcon icon={faXmark} className="hamb-icon" />
        </div>
        <ul className="mobile-navbar-links">
          <div>
            <SearchInput />
          </div>
          <li>
            <Link onClick={openNav} to="/">
              Home
            </Link>
          </li>

          <li className="nav-item dropdown">
            <Link
              className="nav-link dropdown-toggle"
              to={"/categories"}
              data-bs-toggle="dropdown"
            >
              Categories
            </Link>
            <ul className="dropdown-menu">
              <li>
                <Link className="dropdown-item" to={"/categories"}>
                  All Categories
                </Link>
              </li>
              {categories?.map((c) => (
                <li key={c.id}>
                  <Link className="dropdown-item" to={`/category/${c.slug}`}>
                    {c.name}
                  </Link>
                </li>
              ))}
            </ul>
          </li>
          {!auth.user ? (
            <>
              <li className="nav-item">
                <NavLink to="/register" className="nav-link" onClick={openNav}>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="26"
                    viewBox="0 -960 960 960"
                    width="26"
                  >
                    <path d="M98.847-187.694v-88.922q0-31.846 16.039-55.653 16.038-23.807 42.577-37.269 51-26 107.691-42.077 56.692-16.076 133.692-16.076 30 0 55.808 2.423 25.807 2.423 48.191 7.269l-53.075 53.075q-11-2-23.808-2.384-12.808-.385-27.116-.385-71 0-124.423 15.846T185-316.001q-13.615 7.308-19.885 17.077-6.269 9.77-6.269 22.308v28.923h242.307l59.999 59.999H98.848ZM617-157.847 492.847-282 535-324.153l82 82 202-202L861.152-402 617-157.847ZM398.846-492.309q-57.749 0-98.874-41.124-41.124-41.125-41.124-98.874 0-57.75 41.124-98.874 41.125-41.125 98.874-41.125 57.749 0 98.874 41.125 41.125 41.124 41.125 98.874 0 57.749-41.125 98.874-41.125 41.124-98.874 41.124Zm2.307 244.616Zm-2.307-304.614q33 0 56.5-23.5t23.5-56.5q0-33-23.5-56.5t-56.5-23.5q-33 0-56.5 23.5t-23.5 56.5q0 33 23.5 56.5t56.5 23.5Zm0-80Z" />
                  </svg>{" "}
                  Register
                </NavLink>
              </li>
              <li className="nav-item">
                <NavLink to="/login" className="nav-link" onClick={openNav}>
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="24"
                    viewBox="0 -960 960 960"
                    width="24"
                  >
                    <path d="M479.615-140.001V-200h268.076q4.616 0 8.463-3.846 3.846-3.847 3.846-8.463v-535.382q0-4.616-3.846-8.463-3.847-3.846-8.463-3.846H479.615v-59.999h268.076q30.308 0 51.308 21t21 51.308v535.382q0 30.308-21 51.308t-51.308 21H479.615Zm-54.229-169.232-41.537-43.383 97.384-97.385H140.001v-59.998h341.232l-97.384-97.385 41.537-43.383L596.154-480 425.386-309.233Z" />
                  </svg>{" "}
                  Login
                </NavLink>
              </li>
            </>
          ) : (
            <>
              <li className="nav-item dropdown">
                <NavLink
                  className="nav-link dropdown-toggle"
                  to="#"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    height="30"
                    viewBox="0 -960 960 960"
                    width="30"
                  >
                    <path d="M245.498-268.807q51.772-37.346 109.618-58.462Q412.962-348.384 480-348.384q67.038 0 124.884 21.115 57.846 21.116 109.846 58.462 38.424-42.115 59.828-95.525 21.404-53.41 21.404-115.674 0-131.686-92.135-223.821Q611.692-795.962 480-795.962t-223.827 92.135q-92.135 92.135-92.135 223.821 0 62.264 21.404 115.674 21.404 53.41 60.056 95.525Zm234.624-182.809q-54.276 0-91.391-36.993t-37.115-91.269q0-54.276 36.993-91.391t91.269-37.115q54.276 0 91.391 36.993t37.115 91.269q0 54.276-36.993 91.391t-91.269 37.115ZM480-108.078q-77.252 0-145.238-29.225-67.985-29.224-118.123-79.461-50.138-50.237-79.349-118.151-29.212-67.914-29.212-145.181 0-77.349 29.225-145.238 29.224-67.889 79.461-118.027 50.237-50.138 118.151-79.349 67.914-29.212 145.181-29.212 77.349 0 145.238 29.225 67.889 29.224 118.027 79.461 50.138 50.237 79.349 118.038Q851.922-557.397 851.922-480q0 77.252-29.225 145.238-29.224 67.985-79.461 118.123-50.237 50.138-118.038 79.349Q557.397-108.078 480-108.078Zm-.012-55.96q53.358 0 102.57-17.02 49.212-17.019 89.52-48.327-40.308-29.654-88.354-46.346-48.047-16.693-103.652-16.693-55.606 0-104.262 16.154-48.657 16.154-87.888 46.885 40.308 31.308 89.508 48.327 49.201 17.02 102.558 17.02ZM480-507.576q30.346 0 51.385-21.039 21.039-21.039 21.039-51.385 0-30.346-21.039-51.385-21.039-21.039-51.385-21.039-30.346 0-51.385 21.039-21.039 21.039-21.039 51.385 0 30.346 21.039 51.385 21.039 21.039 51.385 21.039ZM480-580Zm0 351.769Z" />
                  </svg>
                  {auth?.user?.name}
                </NavLink>
                <ul className="dropdown-menu">
                  <li>
                    <NavLink
                      to={`/dashboard/${
                        auth?.user?.role === 1 ? "admin" : "user"
                      }`}
                      className="dropdown-item"
                      onClick={openNav}
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        height="24"
                        viewBox="0 -960 960 960"
                        width="24"
                      >
                        <path d="M680-280q25 0 42.5-17.5T740-340q0-25-17.5-42.5T680-400q-25 0-42.5 17.5T620-340q0 25 17.5 42.5T680-280Zm0 120q31.385 0 57.192-14.308 25.808-14.307 42.193-38.307Q757-226 732-233q-25-7-52-7t-52 7q-25 7-47.385 20.385 16.385 24 42.193 38.307Q648.615-160 680-160Zm-200 59.229q-129.769-35.384-214.884-152.768Q180.001-370.924 180.001-516v-230.153L480-858.46l299.999 112.307v226.616q-14-5.693-29.384-10.269-15.385-4.577-30.615-7.193v-167.386L480-794l-240 89.615V-516q0 53.154 15 103.808 15 50.655 41.347 94.693 26.346 44.039 62.962 79.077t79.462 55.961l1.154-.384q7.923 21.999 20.538 42.152 12.615 20.153 28.691 36.614-2.538.77-4.577 1.654-2.038.885-4.577 1.654Zm200 .77q-74.922 0-127.461-52.538Q500.001-205.078 500.001-280t52.538-127.461Q605.078-459.999 680-459.999t127.461 52.538Q859.999-354.922 859.999-280t-52.538 127.461Q754.922-100.001 680-100.001ZM480-488.23Z" />
                      </svg>{" "}
                      Dashboard
                    </NavLink>
                  </li>
                  <li className="dropdown-item">
                    <NavLink
                      onClick={handleLogout}
                      to="/login"
                      className="nav-link"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        height="24"
                        viewBox="0 -960 960 960"
                        width="24"
                      >
                        <path d="M212.309-140.001q-30.308 0-51.308-21t-21-51.308v-535.382q0-30.308 21-51.308t51.308-21h268.076V-760H212.309q-4.616 0-8.463 3.846-3.846 3.847-3.846 8.463v535.382q0 4.616 3.846 8.463 3.847 3.846 8.463 3.846h268.076v59.999H212.309Zm436.922-169.232-41.537-43.383 97.384-97.385H363.846v-59.998h341.232l-97.384-97.385 41.537-43.383L819.999-480 649.231-309.233Z" />
                      </svg>{" "}
                      Logout
                    </NavLink>
                  </li>
                </ul>
              </li>
            </>
          )}
          <li className="nav-item">
            <Badge count={cart?.length} showZero>
              <NavLink to="/cart" className="nav-link" onClick={openNav}>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  height="24"
                  viewBox="0 -960 960 960"
                  width="24"
                >
                  <path d="M252.309-100.001q-30.308 0-51.308-21t-21-51.308v-455.382q0-30.308 21-51.308t51.308-21h77.692v-10q0-62.154 43.923-106.077Q417.846-859.999 480-859.999q62.154 0 106.076 43.923 43.923 43.923 43.923 106.077v10h77.692q30.308 0 51.308 21t21 51.308v455.382q0 30.308-21 51.308t-51.308 21H252.309Zm0-59.999h455.382q4.616 0 8.463-3.846 3.846-3.847 3.846-8.463v-455.382q0-4.616-3.846-8.463-3.847-3.846-8.463-3.846h-77.692v90.001q0 12.769-8.615 21.384T600-520q-12.769 0-21.384-8.615t-8.615-21.384V-640H389.999v90.001q0 12.769-8.615 21.384T360-520q-12.769 0-21.384-8.615t-8.615-21.384V-640h-77.692q-4.616 0-8.463 3.846-3.846 3.847-3.846 8.463v455.382q0 4.616 3.846 8.463 3.847 3.846 8.463 3.846Zm137.69-539.999h180.002v-10q0-37.616-26.193-63.808Q517.616-800 480-800t-63.808 26.193q-26.193 26.192-26.193 63.808v10ZM240-160V-640-160Z" />
                </svg>{" "}
                Cart
              </NavLink>
            </Badge>
          </li>
        </ul>
      </div>

      {/* Hamburger Icon */}
      <div className="mobile-nav">
        <FontAwesomeIcon
          icon={faBars}
          onClick={openNav}
          className="hamb-icon"
        />
      </div>
    </div>
  );
};

export default Header;
